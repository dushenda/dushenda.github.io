---
title: TCP窗口
date: 2025-12-23
tags:
  - TCP
  - 网络
---
# TCP几个窗口概念

TCP窗口大小的单位是**字节**​ 。这意味着窗口大小衡量的是可以发送的**数据字节数**，而不是报文段或帧的数量。

下表总结了TCP通信中几个关键的窗口类型：

|窗口类型|英文全称|控制方|核心作用|
|---|---|---|---|
|**接收窗口 (RWND)**​|Receiver Window|接收端|流量控制，反映接收方应用程序的缓存剩余空间|
|**拥塞窗口 (CWND)**​|Congestion Window|发送端|拥塞控制，根据网络状况动态调整，避免造成网络过载|
|**发送窗口 (SWND)**​|Sender Window|发送端|**实际发送数据的上限**，其大小由RWND和CWND共同决定|

- **为何以字节为单位**：采用字节作为单位提供了极大的灵活性，允许TCP适应各种不同的应用需求（如大文件传输或短小交互命令），而不受底层网络数据包大小分割的限制 。核心目的是实现**流量控制**，确保发送方的发送速率不会超过接收方的处理能力 。
- **流量控制过程**：接收方通过TCP报文首部中的16位“窗口大小”字段，动态地向发送方通告自己的接收窗口剩余容量 。如果接收方缓冲区已满，它会通告一个**零窗口**，此时发送方会暂停发送，并通过**持续计时器**定时发送窗口探测报文，以等待接收方缓冲区空出后恢复传输 。
- **窗口大小的限制与扩展**：由于窗口字段是16位，理论上最大窗口值为65535字节。对于高带宽、高延迟的网络（如卫星链路），这可能成为瓶颈。因此，TCP使用了**窗口缩放选项**，通过一个缩放因子，可以将实际窗口大小最大扩展到约1GB，从而显著提高吞吐量 。

# 窗口之间的关系

$$
SWND=\min(CWND, RWND)
$$

# CWND

CWND是为了避免TCP拥塞产生的，以“不清楚网络情况”为前提，使用几种算法来探测和避免拥塞的。

- 慢启动
- 拥塞避免
- 快速恢复

## 慢启动

收到一个ACK，就将CWND的值增加一个MSS。那么在几轮RTT的表现下，CWND的增加呈现指数级增长。

$$
CWND=CWND+MSS
$$

```mermaid
xychart-beta
        title "慢启动"
        x-axis "RTT" [0, 1, 2, 3, 4, 5, 6]
        y-axis "CWND" 
        line [1, 2, 4, 8, 16, 32, 64]
```

## 拥塞避免

## 快速恢复